# Great Expectations configuration for Privacy Intent Pipeline
# This file configures data quality monitoring and validation

config_version: 3.0

# Data Context configuration
data_context:
  config_version: 3.0
  plugins_directory: plugins/
  config_variables_file_path: uncommitted/config_variables.yml
  stores:
    expectations_store:
      class_name: ExpectationsStore
      store_backend:
        class_name: TupleFilesystemStoreBackend
        base_directory: expectations/
    validations_store:
      class_name: ValidationsStore
      store_backend:
        class_name: TupleFilesystemStoreBackend
        base_directory: uncommitted/validations/
    evaluation_parameter_store:
      class_name: EvaluationParameterStore
      store_backend:
        class_name: TupleFilesystemStoreBackend
        base_directory: evaluation_parameters/
    checkpoint_store:
      class_name: CheckpointStore
      store_backend:
        class_name: TupleFilesystemStoreBackend
        base_directory: checkpoints/
    profiler_store:
      class_name: ProfilerStore
      store_backend:
        class_name: TupleFilesystemStoreBackend
        base_directory: profilers/

# Data Sources configuration
datasources:
  pandas_datasource:
    class_name: PandasDatasource
    data_connectors:
      default_runtime_data_connector_name:
        class_name: RuntimeDataConnector
        batch_identifiers:
          - default_identifier_name

# Validation configuration
validation_operators:
  action_list_operator:
    class_name: ActionListValidationOperator
    action_list:
      - name: store_validation_result
        action:
          class_name: StoreValidationResultAction
      - name: store_evaluation_params
        action:
          class_name: StoreEvaluationParametersAction
      - name: update_data_docs
        action:
          class_name: UpdateDataDocsAction

# Data Docs configuration
data_docs_sites:
  local_site:
    class_name: SiteBuilder
    show_how_to_buttons: true
    store_backend:
      class_name: TupleFilesystemStoreBackend
      base_directory: uncommitted/data_docs/local_site/
    site_index_builder:
      class_name: DefaultSiteIndexBuilder

# Expectations configuration
expectations:
  privacy_intent_suite:
    class_name: ExpectationSuite
    expectations:
      - expectation_type: expect_column_values_to_not_be_null
        kwargs:
          column: text
        meta:
          notes:
            content: "Text field should not be null"
            format: markdown
      
      - expectation_type: expect_column_values_to_not_be_null
        kwargs:
          column: intent
        meta:
          notes:
            content: "Intent field should not be null"
            format: markdown
      
      - expectation_type: expect_column_values_to_be_in_set
        kwargs:
          column: intent
          value_set: ["privacy_request", "data_deletion", "opt_out", "other"]
        meta:
          notes:
            content: "Intent should be one of the valid categories"
            format: markdown
      
      - expectation_type: expect_column_values_to_be_between
        kwargs:
          column: confidence
          min_value: 0.0
          max_value: 1.0
        meta:
          notes:
            content: "Confidence should be between 0 and 1"
            format: markdown
      
      - expectation_type: expect_column_values_to_not_be_null
        kwargs:
          column: timestamp
        meta:
          notes:
            content: "Timestamp should not be null"
            format: markdown
      
      - expectation_type: expect_column_value_lengths_to_be_between
        kwargs:
          column: text
          min_value: 1
          max_value: 10000
        meta:
          notes:
            content: "Text length should be reasonable"
            format: markdown
      
      - expectation_type: expect_table_row_count_to_be_between
        kwargs:
          min_value: 1
          max_value: 1000000
        meta:
          notes:
            content: "Table should have reasonable number of rows"
            format: markdown

# Profiling configuration
profiling:
  privacy_intent_profile:
    class_name: BasicSuiteBuilderProfiler
    data_connector_name: default_runtime_data_connector_name
    data_asset_name: privacy_intent_data
    suite_name: privacy_intent_suite
    profiler_configuration:
      class_name: ProfilerConfiguration
      config_version: 1.0
      rules:
        - rule_name: expect_column_values_to_not_be_null
          column: text
        - rule_name: expect_column_values_to_not_be_null
          column: intent
        - rule_name: expect_column_values_to_be_in_set
          column: intent
          value_set: ["privacy_request", "data_deletion", "opt_out", "other"]
        - rule_name: expect_column_values_to_be_between
          column: confidence
          min_value: 0.0
          max_value: 1.0

# Checkpoints configuration
checkpoints:
  privacy_intent_checkpoint:
    class_name: SimpleCheckpoint
    validations:
      - batch_request:
          datasource_name: pandas_datasource
          data_connector_name: default_runtime_data_connector_name
          data_asset_name: privacy_intent_data
        expectation_suite_name: privacy_intent_suite
    action_list:
      - name: store_validation_result
        action:
          class_name: StoreValidationResultAction
      - name: store_evaluation_params
        action:
          class_name: StoreEvaluationParametersAction
      - name: update_data_docs
        action:
          class_name: UpdateDataDocsAction 